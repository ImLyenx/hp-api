<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="global.css" />
    <script
      defer
      src="https://kit.fontawesome.com/aa06e5f929.js"
      crossorigin="anonymous"
    ></script>
    <meta name="description" content="Harry Potter Trading Card Game" />
    <link
      rel="shortcut icon"
      href="assets/images/logo.png"
      type="image/x-icon"
    />
    <title>Harry Potter TCG</title>
  </head>
  <body>
    <header>
      <div class="logo">
        <img src="assets/images/logo.png" alt="" />
      </div>
      <nav>
        <ul class="navbar-list">
          <li>
            <a href="/">
              <i class="fas fa-house"></i>
              <span class="nav-link">Home</span></a
            >
          </li>
          <li>
            <a href="/rules"
              ><i class="fas fa-clipboard-check"></i
              ><span class="nav-link">Rules</span></a
            >
          </li>
          <li>
            <a href="/cards"
              ><i class="fas fa-sheet-plastic"></i
              ><span class="nav-link">Cards</span></a
            >
          </li>
        </ul>
      </nav>
      <div class="login">
        <i class="fas fa-right-to-bracket"></i>
      </div>
      <div class="user hidden">
        <i class="fas fa-user-large"></i>
      </div>
      <div class="forms hidden">
        <form class="login-form" onsubmit="handleLogin(event)">
          <label for="login-email">Email adress</label>
          <input type="email" id="login-email" />
          <label for="login-password">Password</label>
          <input type="password" id="login-password" />
          <button type="submit">Login</button>

          <span class="tip">Register</span>
        </form>

        <form class="register-form hidden" onsubmit="handleRegister(event)">
          <label for="register-email">Email adress</label>
          <input type="email" id="register-email" />
          <label for="name">Username</label>
          <input type="text" id="name" />
          <label for="register-password">Password</label>
          <input type="password" id="register-password" />
          <button type="submit">Register</button>
          <span class="tip">Login</span>
        </form>

        <div class="user-menu hidden">
          <p class="user-name"></p>
          <p class="user-email"></p>
          <a href="/profile"><button>Profil</button></a>
          <button class="logout">
            <i class="fas fa-user-large-slash"></i>Logout
          </button>
        </div>
      </div>
      <script>
        const loginButton = document.querySelector(".login");
        const forms = document.querySelector(".forms");
        loginButton.addEventListener("click", () => {
          forms.classList.toggle("hidden");
        });

        function loginStatus() {
          if (localStorage.getItem("token")) {
            document.querySelector(".login").classList.add("hidden");
            document.querySelector(".user").classList.remove("hidden");
            document.querySelector(".forms").classList.add("hidden");
          } else {
            document.querySelector(".login").classList.remove("hidden");
            document.querySelector(".user").classList.add("hidden");
            document.querySelector(".forms").classList.add("hidden");
            document.querySelector(".user-menu").classList.add("hidden");
            document.querySelector(".login-form").classList.remove("hidden");
          }
        }
        loginStatus();

        function handleLogin(e) {
          e.preventDefault();
          const email = document.getElementById("login-email").value;
          const password = document.getElementById("login-password").value;
          fetch("/api/auth/login", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ email, password }),
          })
            .then((response) => response.json())
            .then((data) => {
              localStorage.setItem("token", data.token);
              forms.classList.add("hidden");
              document.querySelector("#login-email").value = "";
              document.querySelector("#login-password").value = "";
              loginStatus();
            })
            .catch((error) => {
              console.error("There was an error!", error);
            });
        }

        function handleRegister(e) {
          e.preventDefault();
          const email = document.getElementById("register-email").value;
          const name = document.getElementById("name").value;
          const password = document.getElementById("register-password").value;
          fetch("/api/users", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({ email, name, password }),
          })
            .then((response) => response.json())
            .then((data) => {
              localStorage.setItem("token", data.token);
              forms.classList.add("hidden");
              loginStatus();
            })
            .catch((error) => {
              console.error("There was an error!", error);
            });
        }

        const logoutButton = document.querySelector(".logout");
        logoutButton.addEventListener("click", () => {
          localStorage.removeItem("token");
          loginStatus();
        });

        const userMenuButton = document.querySelector(".user");
        const userMenu = document.querySelector(".user-menu");
        const loginForm = document.querySelector(".login-form");
        userMenuButton.addEventListener("click", () => {
          forms.classList.toggle("hidden");
          userMenu.classList.toggle("hidden");
          loginForm.classList.add("hidden");
          fetch("/api/me/profile", {
            method: "GET",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${localStorage.getItem("token")}`,
            },
          })
            .then((response) => response.json())
            .then((data) => {
              document.querySelector(".user-name").innerText = data.name;
              document.querySelector(".user-email").innerText = data.email;
            })
            .catch((error) => {
              console.error("There was an error!", error);
            });
        });

        const tip = document.querySelectorAll(".tip");
        tip.forEach((element) => {
          element.addEventListener("click", () => {
            document.querySelector(".login-form").classList.toggle("hidden");
            document.querySelector(".register-form").classList.toggle("hidden");
          });
        });
      </script>
      <input type="checkbox" id="burger-toggle" />
      <label for="burger-toggle" class="burger-icon">
        <i class="fas fa-bars"></i>
      </label>
      <div class="burger-menu">
        <ul class="burger-menu-list">
          <li>
            <a href="/">
              <i class="fas fa-house"></i>
              <span>Home</span>
            </a>
          </li>
          <li>
            <a href="/rules">
              <i class="fas fa-clipboard-check"></i>
              <span>Rules</span>
            </a>
          </li>
          <li>
            <a href="/cards">
              <i class="fas fa-sheet-plastic"></i>
              <span>Cards</span>
            </a>
          </li>
        </ul>
      </div>
      <script defer>
        const burgerToggle = document.getElementById("burger-toggle");
        const burgerMenu = document.querySelector(".burger-menu");
        burgerToggle.addEventListener("change", () => {
          if (burgerToggle.checked) {
            burgerMenu.style.transform = "scaleY(1)";
          } else {
            burgerMenu.style.transform = "scaleY(0)";
          }
        });
      </script>
    </header>
    <main>
      <section class="hero-image">
        <img src="../assets/images/wallpaper.webp" alt="" />
        <h1 class="hero-title">Welcome to Hogwarts</h1>
      </section>
      <section id="gallery" class="gallery">
        <img
          src="https://boutique-magic-effect.com/wp-content/uploads/2021/11/Harry-Potter-Jeux-de-cartes-par-Theory11-rouge.jpg"
          alt=""
        />
        <img
          class="inactive"
          src="https://images1.vinted.net/t/02_019ed_b9Jb2w7Ss9PqEDMA8cyiezp7/f800/1689406357.jpeg?s=f03c1851c3f5d5349cbd1353c94cf8874bba029b"
          alt=""
        />
        <img
          class="inactive"
          src="https://i.redd.it/a0d7mf8ydha31.jpg"
          alt=""
        />
        <img
          class="inactive"
          src="https://m.media-amazon.com/images/I/A19OSh+TQeL.jpg"
          alt=""
        />
        <img
          class="inactive"
          src="https://www.gazette-du-sorcier.com/wp-content/uploads/2022/07/20210214_1422151-1024x768.jpg"
          alt=""
        />
        <img
          class="inactive"
          src="https://tools.toywiz.com/_images/_webp/_products/lg/hapocagabset.webp"
          alt=""
        />
      </section>
      <script async type="module">
        const gallery = document.getElementById("gallery");
        let image = 1;

        function rotate() {
          window.marginvalue = window.innerWidth < 1024 ? 25 : 35;
          window.offsetvalue = window.innerWidth < 1024 ? -70 : -50;
          if (image != 6) {
            [...gallery.children].forEach((img) => {
              img.classList.add("inactive");
            });
            gallery.children[image].classList.remove("inactive");
            gallery.style.marginLeft = `${
              image * window.offsetvalue + window.marginvalue
            }vw`;
            image++;
          } else {
            gallery.children[0].classList.remove("inactive");
            gallery.style.marginLeft = `${window.marginvalue}vw`;
            image = 1;
          }
        }

        setInterval(rotate, 3000);
      </script>
      <section class="main-content">
        <div class="about">
          <h2>About</h2>
          <p>
            Bienvenue dans le monde envoûtant des cartes à collectionner Harry
            Potter! Plongez dans l'univers magique de Poudlard, où chaque carte
            renferme un sortilège, une créature fantastique ou un personnage
            emblématique de la saga. Notre jeu offre une expérience immersive où
            les joueurs peuvent explorer les couloirs de Poudlard, affronter des
            adversaires redoutables et découvrir des trésors cachés. Avec des
            illustrations époustouflantes et des mécaniques de jeu innovantes,
            notre jeu de cartes à collectionner offre une expérience unique aux
            fans d'Harry Potter. Collectionnez des cartes rares, construisez
            votre propre deck de sorts et défiez vos amis lors de duels épiques.
            Que vous soyez un sorcier débutant ou un expert en magie, notre jeu
            offre quelque chose pour tous les niveaux de compétence. Rejoignez
            une communauté passionnée de fans d'Harry Potter et partagez votre
            amour pour la magie. Que vous préfériez collectionner des cartes,
            participer à des tournois ou échanger des stratégies avec d'autres
            sorciers, vous trouverez toujours quelque chose de captivant à faire
            dans notre jeu. Préparez-vous à vivre des aventures inoubliables et
            à découvrir les mystères de Poudlard dans notre jeu de cartes à
            collectionner Harry Potter!
          </p>
        </div>
        <div class="contact">
          <h2>Contact</h2>
          <form>
            <label for="name">Name</label>
            <input type="text" id="name" placeholder="Your name" />
            <label for="email">Email</label>
            <input type="email" id="email" placeholder="Your email" />
            <label for="message">Message</label>
            <textarea
              name="message"
              id="message"
              cols="30"
              rows="10"
              placeholder="Your message"
            ></textarea>
            <button type="submit">Send</button>
          </form>
        </div>
        <div class="news">
          <h2>News</h2>
          <div class="articles-container">
            <article>
              <h3>Les Sorts les Plus Puissants de l'Univers d'Harry Potter</h3>
              <p>
                Découvrez les sorts les plus redoutables de l'univers d'Harry
                Potter et apprenez comment les maîtriser pour devenir un sorcier
                de renom.
              </p>
            </article>
            <article>
              <h3>Les Créatures Magiques les Plus Fascinantes de Poudlard</h3>
              <p>
                Plongez dans le monde fantastique de Poudlard et explorez les
                créatures magiques les plus fascinantes qui peuplent ses
                couloirs et ses forêts interdites.
              </p>
            </article>
            <article>
              <h3>
                Les Maisons de Poudlard : Gryffondor, Serpentard, Serdaigle,
                Poufsouffle
              </h3>
              <p>
                Découvrez l'histoire et les valeurs des quatre maisons de
                Poudlard et choisissez celle qui correspond le mieux à votre
                personnalité magique.
              </p>
            </article>
            <article>
              <h3>Les Secrets Cachés de Poudlard</h3>
              <p>
                Explorez les recoins mystérieux de Poudlard et découvrez les
                secrets enfouis dans ses murs centenaires. Des passages secrets
                aux salles hantées, préparez-vous à être émerveillé.
              </p>
            </article>
          </div>
        </div>
      </section>
    </main>
    <footer>
      <div class="socials">
        <a href="#"><i class="fab fa-youtube"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-instagram"></i></a>
      </div>
      <div class="legal">
        <a href="#">Terms of Use</a>
        <p>&middot;</p>
        <a href="#">Privacy Policy</a>
        <p>&middot;</p>
        <p id="theme-change">Dark Mode</p>
      </div>
      <div class="copyright">
        <p>&copy; Eric Hubert, <span id="copy-date"></span></p>
      </div>
      <script async type="module">
        document.getElementById("copy-date").innerText =
          new Date().getFullYear();

        const themeChange = document.getElementById("theme-change");
        if (localStorage.getItem("theme") === "dark") {
          document.body.classList.add("dark");
          themeChange.innerText = "Light Mode";
        }
        themeChange.addEventListener("click", () => {
          console.log("test");
          document.body.classList.toggle("dark");
          localStorage.setItem(
            "theme",
            document.body.classList.contains("dark") ? "dark" : "light"
          );
          themeChange.innerText = document.body.classList.contains("dark")
            ? "Light Mode"
            : "Dark Mode";
        });
      </script>
    </footer>
  </body>
</html>
